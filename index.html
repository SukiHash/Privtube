<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PrivTube</title>
  <style>
    /* Styling with private colors */
    body {
      font-family: Arial, sans-serif;
      background-color: #1a1a1a; /* Dark background */
      color: #fff; /* White text */
      margin: 0;
      padding: 0;
      display: flex;
    }
    #sidebar {
      width: 200px;
      background-color: #333; /* Dark sidebar background */
      height: 100vh; /* Full height sidebar */
      padding-top: 20px;
      position: fixed;
      left: 0;
      overflow-y: auto; /* Allow scrolling if needed */
    }
    #sidebar a {
      display: block;
      padding: 10px 20px;
      color: #fff;
      text-decoration: none;
      font-size: 18px;
      transition: background-color 0.3s;
    }
    #sidebar a:hover {
      background-color: #555; /* Darker on hover */
    }
    #sidebar a.active {
      background-color: #FF0000; /* Red background for active link */
    }
    #main {
      margin-left: 200px; /* Adjust main content area */
      padding: 20px;
      width: 80%;
    }
    #title {
      text-align: center;
      font-size: 24px;
      margin-top: 20px;
    }
    #search-container {
      text-align: center;
      margin-top: 30px;
      margin-bottom: 20px;
    }
    #searchInput {
      padding: 8px;
      width: 300px;
      font-size: 16px;
      background-color: #333; /* Darker input background */
      color: #fff; /* White text */
      border: 1px solid #666; /* Dark border */
      border-radius: 4px;
    }
    #searchButton {
      padding: 8px 16px;
      font-size: 16px;
      cursor: pointer;
      background-color: #FF0000; /* Red button */
      color: #fff; /* White text */
      border: none;
      border-radius: 4px;
      margin-left: 10px;
    }
    #searchButton:hover {
      background-color: #FF3333; /* Lighter red on hover */
    }
    #video-container {
      background-color: #333; /* Dark container background */
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      overflow: hidden;
    }
    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      grid-gap: 20px;
    }
    .video-item {
      padding: 10px;
      background-color: #444; /* Darker video item background */
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .video-item:hover {
      background-color: #555; /* Slightly lighter on hover */
    }
    .video-thumbnail {
      width: 100%;
      height: auto;
      border-radius: 4px;
    }
    .video-title {
      margin-top: 10px;
      font-size: 16px;
      font-weight: bold;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: none;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div id="sidebar">
    <a href="#" id="homeLink" onclick="loadHome()">Home</a>
    <a href="#" onclick="loadShorts()">Shorts</a>
    <a href="#" onclick="History()">History</a>
  </div>

  <!-- Main content -->
  <div id="main">
    <div id="title">
      PrivTube - Home
    </div>

    <div id="search-container">
      <input type="text" id="searchInput" placeholder="Search YouTube">
      <button id="searchButton" onclick="searchVideos()">Search</button>
    </div>

    <div id="video-container">
      <div class="video-grid" id="videoGrid"></div>
    </div>
  </div>

  <script>
    let nextPageToken = ''; // Variable to store the next page token
    let isLoading = false; // Variable to prevent multiple simultaneous requests
    let history = []; // Array to store history

        // API keys
    const homeAPIKey = 'AIzaSyC7r_0nZUd5YpfwyDFcjrKRy1Fhw_bs4I4';
    const searchAPIKey = 'AIzaSyBJqBurHNMVkVMTqgLgnZARm_6lDUy5GkA';

    function searchVideos() {
      var searchQuery = document.getElementById('searchInput').value.trim();
      if (searchQuery === '') return;

      nextPageToken = ''; // Reset token when a new search is performed
      clearVideoContainer(); // Clear existing videos
      addToHistory(searchQuery); // Add to history
      loadVideos(searchQuery, searchAPIKey); // Use search API key
    }

    function loadVideos(keyword, apiKey) {
      if (isLoading) return;

      isLoading = true;
      var url = `https://www.googleapis.com/youtube/v3/search?key=${apiKey}&type=video&part=snippet&q=${keyword}&pageToken=${nextPageToken}&maxResults=20`;

      // Fetching YouTube API
      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.items) {
            displayVideos(data.items);
            nextPageToken = data.nextPageToken || ''; // Update the next page token
          }
          isLoading = false;
        })
        .catch(error => {
          console.error('Error fetching videos:', error);
          isLoading = false;
        });
    }

    function displayVideos(videos) {
      var videoGrid = document.getElementById('videoGrid');

      videos.forEach(video => {
        if (!video.id.videoId) return; // Skip videos without ID (e.g., channels)

        var videoId = video.id.videoId;
        var videoTitle = video.snippet.title;
        var videoThumbnail = video.snippet.thumbnails.medium.url;

        // Create a container for video item with thumbnail and title
        var videoItem = document.createElement('div');
        videoItem.classList.add('video-item');

        // Create thumbnail image element
        var thumbnailImg = document.createElement('img');
        thumbnailImg.classList.add('video-thumbnail');
        thumbnailImg.src = videoThumbnail;

        // Create a div for video title
        var titleDiv = document.createElement('div');
        titleDiv.classList.add('video-title');
        titleDiv.textContent = videoTitle;

        // Append thumbnail and title to the video item container
        videoItem.appendChild(thumbnailImg);
        videoItem.appendChild(titleDiv);

        // Handle click event to embed video
        videoItem.onclick = function() {
          embedVideo(videoId);
        };

        // Append video item to the video grid
        videoGrid.appendChild(videoItem);
      });
    }

    function embedVideo(videoId) {
      var videoGrid = document.getElementById('videoGrid');
      videoGrid.innerHTML += `<iframe width="100%" height="400" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe>`;
    }

    function clearVideoContainer() {
      var videoGrid = document.getElementById('videoGrid');
      videoGrid.innerHTML = ''; // Remove existing videos
    }

    // Function to add to history
    function addToHistory(query) {
      history.push(query);
    }

    // Function to load history (not implemented in this example)
    function History() {
      history = [];
      alert('History feature is not implemented.');
    }

    // Load home videos initially
    function loadHome() {
      clearVideoContainer(); // Clear existing videos
      document.getElementById('homeLink').classList.add('active'); // Highlight Home link
      loadVideos('', homeAPIKey); // Use home API key for initial load
    }

    // Load shorts (not implemented in this example)
    function loadShorts() {
      alert('Shorts feature is not implemented.');
    }

    // Initial load of home videos
    loadHome();

    // Infinite scrolling implementation
    window.addEventListener('scroll', scrollListener);

    function scrollListener() {
      if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
        var searchQuery = document.getElementById('searchInput').value.trim();
        if (searchQuery !== '') {
          loadVideos(searchQuery, searchAPIKey); // Load more videos for the current search query
        } else {
          loadVideos('', homeAPIKey); // Load more videos for home
        }
      }
    }
  </script>
</body>
</html>
